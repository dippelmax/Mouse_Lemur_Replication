data <- read.csv("mouse_lemur_data.csv", header = TRUE)
data$species_number <- as.numeric(as.factor(data$scientificName))
data$seedling_mm <- as.numeric(data$seedling_length_mm)
data$germ_time <- as.numeric(data$germination_time)
data$ratio <- as.numeric( factor(data$germination_state) ) - 1
# Subsetting the data to only include seeds dispersed by microcebus rufus
rufus <- subset(data, disperser == "microcebus_rufus")
# Subsetting the data to only include seeds dispersed by microcebus rufus in the petri dish experiment
rufus_petri <- subset(rufus, experiment == "Petri dish")
nrow(rufus_petri)
# The number of total observations in the experiment is 685
# Now, I am subsettung the data to only have seeds which germinated
rufus_petri_yes <- subset(rufus_petri, germination_state == "yes")
nrow(rufus_petri_yes)
# The number of germinated seeds is 121
# This creates summary statistics for seedling growth for each species
rufus_petri_yes_summary <- rufus_petri_yes %>%
group_by(scientificName, treatment) %>%
summarise(seedling_mean = mean(seedling_mm),
N = n())
####  This line modifies the summary statistics to include only the species for which there is a defecated and control. This step was not explicitly stated anywhere in the paper and it took me a very long time to figure it out.
rufus_petri_yes_summary_modified <- rufus_petri_yes_summary[-c(3, 4, 5, 6, 7, 12), ]
sum(rufus_petri_yes_summary_modified$N)
# 88
# Subsetting the data to only include seeds dispersed by microcebus rufus in the forest ground experiment
rufus_ground <- subset(rufus, experiment == "Forest ground")
nrow(rufus_ground)
# The number of total observations in the experiment is 231
# Now, I am subsettung the data to only have seeds which germinated
rufus_ground_yes <- subset(rufus_ground, germination_state == "yes")
nrow(rufus_ground_yes)
#The number of germinated seeds is 7
# Subsetting the data to only include seeds dispersed by microcebus jollyae
jollyae <- subset(data, disperser == "microcebus_jollyae")
# Subsetting the jollyae data to only include seeds in the petri dish experiment
jollyae_petri <- subset(jollyae, experiment == "Petri dish")
nrow(jollyae_petri)
# The number of total observations in the experiment is 528
# Now, I am subsettung the data to only have seeds which germinated
jollyae_petri_yes <- subset(jollyae_petri, germination_state == "yes")
nrow(jollyae_petri_yes)
# The number of germinated seeds is 70
# This creates summary statistics for seedling growth for each species
jollyae_petri_yes_summary <- jollyae_petri_yes %>%
group_by(scientificName, treatment) %>%
summarise(seedling_mean = mean(seedling_mm), germ_time = mean(germ_time),
N = n())
####  This line modifies the summary statistics to include only the species for which there is a defecated and control
jollyae_petri_yes_summary_modified <- jollyae_petri_yes_summary[-c(1, 2, 3), ]
jollyae_petri_yes_summary_modified
sum(jollyae_petri_yes_summary_modified$N)
# 25
# Subsetting the jollyae data to only include seeds in the shaded plot experiment
jollyae_closed <- subset(jollyae, experiment == "Closed")
nrow(jollyae_closed)
# 694
jollyae_closed_yes <- subset(jollyae_closed, germination_state == "yes")
nrow(jollyae_closed_yes)
# 61
# This creates summary statistics for seedling growth for each species
jollyae_closed_yes_summary <- jollyae_closed_yes %>%
group_by(scientificName, treatment) %>%
summarise(seedling_mean = mean(seedling_mm), germ_time = mean(germ_time),
N = n())
# This line modifies the summary statistics to include only the species for which there is a defecated and control
jollyae_closed_yes_summary_modified <- jollyae_closed_yes_summary[-c(5, 6), ]
jollyae_closed_yes_summary_modified
sum(jollyae_closed_yes_summary_modified$N)
#43
# Subsetting the jollyae data to only include seeds in the semi-shaded plot experiment
jollyae_semi <- subset(jollyae, experiment == "Semi-closed")
nrow(jollyae_semi)
# 660
jollyae_semi_yes <- subset(jollyae_semi, germination_state == "yes")
nrow(jollyae_semi_yes)
# 233
# This creates summary statistics for seedling growth for each species
jollyae_semi_yes_summary <- jollyae_semi_yes %>%
group_by(scientificName, treatment) %>%
summarise(seedling_mean = mean(seedling_mm), germ_time = mean(germ_time),
N = n())
####  This line modifies the summary statistics to include only the species for which there is a defecated and control
jollyae_semi_yes_summary_modified <- jollyae_semi_yes_summary
jollyae_semi_yes_summary_modified
sum(jollyae_semi_yes_summary_modified$N)
#233
ggplot(data = rufus_petri_yes, aes(x = treatment, y = seedling_mm)) +
geom_point() + theme_bw() + geom_violin( aes(colour = treatment, fill = treatment)) +
stat_summary(fun = mean, geom="point", shape=23, size=5, fill = "black") +
labs(title = "Microcebus rufus",subtitle = "Petri dish",
y = "mean seedling length (mm)", x = "Treatment") +
theme(plot.title = element_text(face = "italic")) +
theme(plot.subtitle = element_text(hjust = 0.5)) +
scale_color_manual(values=c("darkgreen", "darkorange3")) +
scale_fill_manual(values=c("darkgreen", "darkorange3")) +
theme(legend.position = "None")
# This caption is to be added later using word (as done in the original study)
#  N = 37(75) 51(75)
# First we have the Petri dish experiment
plot1 <- ggplot(data = jollyae_petri_yes, aes(x = treatment, y = seedling_mm)) +
theme_bw() + geom_violin( aes(colour = treatment, fill = treatment)) +
stat_summary(fun = mean, geom="point", shape=23, size=5, fill = "black") +
ylim(0,50) +
labs(title = "Microcebus jollyae",subtitle = "Petri dish",
y = "mean seedling length (mm)", x = "Treatment") +
theme(plot.title = element_text(face = "italic")) +
theme(plot.subtitle = element_text(hjust = 0.5)) +
scale_color_manual(values=c("darkgreen", "darkorange3")) +
scale_fill_manual(values=c("darkgreen", "darkorange3")) +
theme(legend.position = "None")
# Next we have the semi-shaded plots
plot2 <- ggplot(data = jollyae_semi_yes, aes(x = treatment, y = seedling_mm)) +
theme_bw() + geom_violin( aes(colour = treatment, fill = treatment)) +
stat_summary(fun = mean, geom="point", shape=23, size=5, fill = "black") +
ylim(0,50) +
labs(title = "",subtitle = "Semi-shaded",
y = "mean seedling length (mm)", x = "Treatment") +
theme(plot.title = element_text(face = "italic")) +
theme(plot.subtitle = element_text(hjust = 0.5)) +
scale_color_manual(values=c("darkgreen", "darkorange3")) +
scale_fill_manual(values=c("darkgreen", "darkorange3")) +
theme(legend.position = "None") +
theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.y = element_blank())
# Then we have the shaded plots
plot3 <- ggplot(data = jollyae_closed_yes, aes(x = treatment, y = seedling_mm)) +
theme_bw() + geom_violin( aes(colour = treatment, fill = treatment)) +
stat_summary(fun = mean, geom="point", shape=23, size=5, fill = "black") +
ylim(0,50) +
labs(title = "",subtitle = "Shaded",
y = "mean seedling length (mm)", x = "Treatment") +
theme(plot.title = element_text(face = "italic")) +
theme(plot.subtitle = element_text(hjust = 0.5)) +
scale_color_manual(values=c("darkgreen", "darkorange3")) +
scale_fill_manual(values=c("darkgreen", "darkorange3")) +
theme(legend.position = "None") +
theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.y = element_blank())
# Now I will add them together
ggarrange(plot1, plot2, plot3, ncol = 3, nrow = 1)
# Just like the first graph, a caption is to be added later using word (as done in the original study)
# REML = FALSE, intercept model
lme_rufus_petri_yes_summary_modified1 <- lmer(data = rufus_petri_yes_summary_modified, seedling_mean ~ treatment + (1 | scientificName), REML = FALSE)
summary(lme_rufus_petri_yes_summary_modified1)
# REML = FALSE , slope model
# lme_rufus_petri_yes_summary_modified2 <- lmer(data = rufus_petri_yes_summary_modified, seedling_mean ~ treatment + (1 + treatment | scientificName), REML = FALSE)
# summary(lme_rufus_petri_yes_summary_modified2)
# will not run
# REML = FALSE , slope and intercept model
# lme_rufus_petri_yes_summary_modified3 <- lmer(data = rufus_petri_yes_summary_modified, seedling_mean ~ treatment + (1 | scientificName) + (1 + treatment | scientificName), REML = FALSE)
# summary(lme_rufus_petri_yes_summary_modified3)
# will not run
null1 <- lmer(data = rufus_petri_yes_summary_modified, seedling_mean ~ 1 + (1 | scientificName), REML = FALSE)
summary(null1)
anova(null1, lme_rufus_petri_yes_summary_modified1, test = "Chisq")
r.squaredGLMM(lme_rufus_petri_yes_summary_modified1)
# lme_rufus_ground_yes_summary_modified1 <- lmer(data = rufus_ground_yes_summary_modified, seedling_mean ~ treatment + (1 | scientificName), REML = FALSE)
# summary(lme_rufus_ground_yes_summary_modified1)
# lme_jollyae_petri_yes_summary_modified1 <- lmer(data = jollyae_petri_yes_summary_modified, seedling_mean ~ treatment + (1 | scientificName), REML = FALSE)
# summary(lme_jollyae_petri_yes_summary_modified1)
lme_jollyae_semi_yes_summary_modified1 <- lmer(data = jollyae_semi_yes_summary_modified, seedling_mean ~ treatment + (1 | scientificName), REML = FALSE)
summary(lme_jollyae_semi_yes_summary_modified1)
null2 <- lmer(data = jollyae_semi_yes_summary_modified, seedling_mean ~ 1 + (1 | scientificName), REML = FALSE)
anova(null2, lme_jollyae_semi_yes_summary_modified1, test = "Chisq")
r.squaredGLMM(lme_jollyae_semi_yes_summary_modified1)
lme_jollyae_closed_yes_summary_modified1 <- lmer(data = jollyae_closed_yes_summary_modified, seedling_mean ~ treatment + (1 | scientificName), REML = FALSE)
summary(lme_jollyae_closed_yes_summary_modified1)
null3 <- lmer(data = jollyae_closed_yes_summary_modified, seedling_mean ~ 1 + (1 | scientificName), REML = FALSE)
anova(null3, lme_jollyae_closed_yes_summary_modified1, test = "Chisq")
r.squaredGLMM(lme_jollyae_closed_yes_summary_modified1)
lme_rufus_petri_yes_summary_modified1_germ_time <- lmer(data = rufus_petri_yes_summary_modified, germ_time ~ treatment + (1 | scientificName), REML = FALSE)
rufus_petri_yes_summary_modifie
rufus_petri_yes_summary_modified
library(lme4)
library(ggplot2)
library(ggfortify)
library(Hmisc)
library(ggpubr)
library(MuMIn)
library(tidyverse)
library(survival)
data <- read.csv("mouse_lemur_data.csv", header = TRUE)
data$species_number <- as.numeric(as.factor(data$scientificName))
data$seedling_mm <- as.numeric(data$seedling_length_mm)
data$germ_time <- as.numeric(data$germination_time)
data$ratio <- as.numeric( factor(data$germination_state) ) - 1
# Subsetting the data to only include seeds dispersed by microcebus rufus
rufus <- subset(data, disperser == "microcebus_rufus")
# Subsetting the data to only include seeds dispersed by microcebus rufus in the petri dish experiment
rufus_petri <- subset(rufus, experiment == "Petri dish")
nrow(rufus_petri)
# The number of total observations in the experiment is 685
# Now, I am subsettung the data to only have seeds which germinated
rufus_petri_yes <- subset(rufus_petri, germination_state == "yes")
nrow(rufus_petri_yes)
# The number of germinated seeds is 121
# This creates summary statistics for seedling growth for each species
rufus_petri_yes_summary <- rufus_petri_yes %>%
group_by(scientificName, treatment) %>%
summarise(seedling_mean = mean(seedling_mm), germ_time = mean(germ_time),
N = n())
####  This line modifies the summary statistics to include only the species for which there is a defecated and control. This step was not explicitly stated anywhere in the paper and it took me a very long time to figure it out.
rufus_petri_yes_summary_modified <- rufus_petri_yes_summary[-c(3, 4, 5, 6, 7, 12), ]
sum(rufus_petri_yes_summary_modified$N)
# 88
# Subsetting the data to only include seeds dispersed by microcebus rufus in the forest ground experiment
rufus_ground <- subset(rufus, experiment == "Forest ground")
nrow(rufus_ground)
# The number of total observations in the experiment is 231
# Now, I am subsettung the data to only have seeds which germinated
rufus_ground_yes <- subset(rufus_ground, germination_state == "yes")
nrow(rufus_ground_yes)
#The number of germinated seeds is 7
# Subsetting the data to only include seeds dispersed by microcebus jollyae
jollyae <- subset(data, disperser == "microcebus_jollyae")
# Subsetting the jollyae data to only include seeds in the petri dish experiment
jollyae_petri <- subset(jollyae, experiment == "Petri dish")
nrow(jollyae_petri)
# The number of total observations in the experiment is 528
# Now, I am subsettung the data to only have seeds which germinated
jollyae_petri_yes <- subset(jollyae_petri, germination_state == "yes")
nrow(jollyae_petri_yes)
# The number of germinated seeds is 70
# This creates summary statistics for seedling growth for each species
jollyae_petri_yes_summary <- jollyae_petri_yes %>%
group_by(scientificName, treatment) %>%
summarise(seedling_mean = mean(seedling_mm), germ_time = mean(germ_time),
N = n())
####  This line modifies the summary statistics to include only the species for which there is a defecated and control
jollyae_petri_yes_summary_modified <- jollyae_petri_yes_summary[-c(1, 2, 3), ]
sum(jollyae_petri_yes_summary_modified$N)
# 25
# Subsetting the jollyae data to only include seeds in the shaded plot experiment
jollyae_closed <- subset(jollyae, experiment == "Closed")
nrow(jollyae_closed)
# 694
jollyae_closed_yes <- subset(jollyae_closed, germination_state == "yes")
nrow(jollyae_closed_yes)
# 61
# This creates summary statistics for seedling growth for each species
jollyae_closed_yes_summary <- jollyae_closed_yes %>%
group_by(scientificName, treatment) %>%
summarise(seedling_mean = mean(seedling_mm), germ_time = mean(germ_time),
N = n())
# This line modifies the summary statistics to include only the species for which there is a defecated and control
jollyae_closed_yes_summary_modified <- jollyae_closed_yes_summary[-c(5, 6), ]
sum(jollyae_closed_yes_summary_modified$N)
#43
# Subsetting the jollyae data to only include seeds in the semi-shaded plot experiment
jollyae_semi <- subset(jollyae, experiment == "Semi-closed")
nrow(jollyae_semi)
# 660
jollyae_semi_yes <- subset(jollyae_semi, germination_state == "yes")
nrow(jollyae_semi_yes)
# 233
# This creates summary statistics for seedling growth for each species
jollyae_semi_yes_summary <- jollyae_semi_yes %>%
group_by(scientificName, treatment) %>%
summarise(seedling_mean = mean(seedling_mm), germ_time = mean(germ_time),
N = n())
####  This line modifies the summary statistics to include only the species for which there is a defecated and control
jollyae_semi_yes_summary_modified <- jollyae_semi_yes_summary
jollyae_semi_yes_summary_modified
sum(jollyae_semi_yes_summary_modified$N)
#233
ggplot(data = rufus_petri_yes, aes(x = treatment, y = seedling_mm)) +
geom_point() + theme_bw() + geom_violin( aes(colour = treatment, fill = treatment)) +
stat_summary(fun = mean, geom="point", shape=23, size=5, fill = "black") +
labs(title = "Microcebus rufus",subtitle = "Petri dish",
y = "mean seedling length (mm)", x = "Treatment") +
theme(plot.title = element_text(face = "italic")) +
theme(plot.subtitle = element_text(hjust = 0.5)) +
scale_color_manual(values=c("darkgreen", "darkorange3")) +
scale_fill_manual(values=c("darkgreen", "darkorange3")) +
theme(legend.position = "None")
# This caption is to be added later using word (as done in the original study)
#  N = 37(75) 51(75)
# First we have the Petri dish experiment
plot1 <- ggplot(data = jollyae_petri_yes, aes(x = treatment, y = seedling_mm)) +
theme_bw() + geom_violin( aes(colour = treatment, fill = treatment)) +
stat_summary(fun = mean, geom="point", shape=23, size=5, fill = "black") +
ylim(0,50) +
labs(title = "Microcebus jollyae",subtitle = "Petri dish",
y = "mean seedling length (mm)", x = "Treatment") +
theme(plot.title = element_text(face = "italic")) +
theme(plot.subtitle = element_text(hjust = 0.5)) +
scale_color_manual(values=c("darkgreen", "darkorange3")) +
scale_fill_manual(values=c("darkgreen", "darkorange3")) +
theme(legend.position = "None")
# Next we have the semi-shaded plots
plot2 <- ggplot(data = jollyae_semi_yes, aes(x = treatment, y = seedling_mm)) +
theme_bw() + geom_violin( aes(colour = treatment, fill = treatment)) +
stat_summary(fun = mean, geom="point", shape=23, size=5, fill = "black") +
ylim(0,50) +
labs(title = "",subtitle = "Semi-shaded",
y = "mean seedling length (mm)", x = "Treatment") +
theme(plot.title = element_text(face = "italic")) +
theme(plot.subtitle = element_text(hjust = 0.5)) +
scale_color_manual(values=c("darkgreen", "darkorange3")) +
scale_fill_manual(values=c("darkgreen", "darkorange3")) +
theme(legend.position = "None") +
theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.y = element_blank())
# Then we have the shaded plots
plot3 <- ggplot(data = jollyae_closed_yes, aes(x = treatment, y = seedling_mm)) +
theme_bw() + geom_violin( aes(colour = treatment, fill = treatment)) +
stat_summary(fun = mean, geom="point", shape=23, size=5, fill = "black") +
ylim(0,50) +
labs(title = "",subtitle = "Shaded",
y = "mean seedling length (mm)", x = "Treatment") +
theme(plot.title = element_text(face = "italic")) +
theme(plot.subtitle = element_text(hjust = 0.5)) +
scale_color_manual(values=c("darkgreen", "darkorange3")) +
scale_fill_manual(values=c("darkgreen", "darkorange3")) +
theme(legend.position = "None") +
theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.y = element_blank())
# Now I will add them together
ggarrange(plot1, plot2, plot3, ncol = 3, nrow = 1)
# Just like the first graph, a caption is to be added later using word (as done in the original study)
# REML = FALSE, intercept model
lme_rufus_petri_yes_summary_modified1 <- lmer(data = rufus_petri_yes_summary_modified, seedling_mean ~ treatment + (1 | scientificName), REML = FALSE)
summary(lme_rufus_petri_yes_summary_modified1)
# REML = FALSE , slope model
# lme_rufus_petri_yes_summary_modified2 <- lmer(data = rufus_petri_yes_summary_modified, seedling_mean ~ treatment + (1 + treatment | scientificName), REML = FALSE)
# summary(lme_rufus_petri_yes_summary_modified2)
# will not run
# REML = FALSE , slope and intercept model
# lme_rufus_petri_yes_summary_modified3 <- lmer(data = rufus_petri_yes_summary_modified, seedling_mean ~ treatment + (1 | scientificName) + (1 + treatment | scientificName), REML = FALSE)
# summary(lme_rufus_petri_yes_summary_modified3)
# will not run
null1 <- lmer(data = rufus_petri_yes_summary_modified, seedling_mean ~ 1 + (1 | scientificName), REML = FALSE)
summary(null1)
anova(null1, lme_rufus_petri_yes_summary_modified1, test = "Chisq")
r.squaredGLMM(lme_rufus_petri_yes_summary_modified1)
# lme_rufus_ground_yes_summary_modified1 <- lmer(data = rufus_ground_yes_summary_modified, seedling_mean ~ treatment + (1 | scientificName), REML = FALSE)
# summary(lme_rufus_ground_yes_summary_modified1)
# lme_jollyae_petri_yes_summary_modified1 <- lmer(data = jollyae_petri_yes_summary_modified, seedling_mean ~ treatment + (1 | scientificName), REML = FALSE)
# summary(lme_jollyae_petri_yes_summary_modified1)
lme_jollyae_semi_yes_summary_modified1 <- lmer(data = jollyae_semi_yes_summary_modified, seedling_mean ~ treatment + (1 | scientificName), REML = FALSE)
summary(lme_jollyae_semi_yes_summary_modified1)
null2 <- lmer(data = jollyae_semi_yes_summary_modified, seedling_mean ~ 1 + (1 | scientificName), REML = FALSE)
anova(null2, lme_jollyae_semi_yes_summary_modified1, test = "Chisq")
r.squaredGLMM(lme_jollyae_semi_yes_summary_modified1)
lme_jollyae_closed_yes_summary_modified1 <- lmer(data = jollyae_closed_yes_summary_modified, seedling_mean ~ treatment + (1 | scientificName), REML = FALSE)
summary(lme_jollyae_closed_yes_summary_modified1)
null3 <- lmer(data = jollyae_closed_yes_summary_modified, seedling_mean ~ 1 + (1 | scientificName), REML = FALSE)
anova(null3, lme_jollyae_closed_yes_summary_modified1, test = "Chisq")
r.squaredGLMM(lme_jollyae_closed_yes_summary_modified1)
lme_rufus_petri_yes_summary_modified1_germ_time <- lmer(data = rufus_petri_yes_summary_modified, germ_time ~ treatment + (1 | scientificName), REML = FALSE)
summary(lme_rufus_petri_yes_summary_modified1_germ_time)
null4 <- lmer(data = rufus_petri_yes_summary_modified, germ_time ~ 1 + (1 | scientificName), REML = FALSE)
anova(null4, lme_rufus_petri_yes_summary_modified1_germ_time, test = "Chisq")
r.squaredGLMM(lme_rufus_petri_yes_summary_modified1_germ_time)
# lme_jollyae_petri_yes_summary_modified1_germ_time <- lmer(data = jollyae_petri_yes_summary_modified, germ_time ~ treatment + (1 | scientificName), REML = FALSE)
# summary(lme_jollyae_petri_yes_summary_modified1_germ_time)
lme_jollyae_semi_yes_summary_modified1_germ_time <- lmer(data = jollyae_semi_yes_summary_modified, germ_time ~ treatment + (1 | scientificName), REML = FALSE)
summary(lme_jollyae_semi_yes_summary_modified1_germ_time)
null5 <- lmer(data = jollyae_semi_yes_summary_modified, germ_time ~ 1 + (1 | scientificName), REML = FALSE)
anova(null5, lme_jollyae_semi_yes_summary_modified1_germ_time, test = "Chisq")
r.squaredGLMM(lme_jollyae_semi_yes_summary_modified1_germ_time)
lme_jollyae_closed_yes_summary_modified1_germ_time <- lmer(data = jollyae_closed_yes_summary_modified, germ_time ~ treatment + (1 | scientificName), REML = FALSE)
summary(lme_jollyae_closed_yes_summary_modified1_germ_time)
null6 <- lmer(data = jollyae_closed_yes_summary_modified, germ_time ~ 1 + (1 | scientificName), REML = FALSE)
anova(null6, lme_jollyae_closed_yes_summary_modified1_germ_time, test = "Chisq")
r.squaredGLMM(lme_jollyae_closed_yes_summary_modified1_germ_time)
rufus_petri_ratio_summary <- rufus_petri %>%
group_by(scientificName, treatment) %>%
summarise( germ_ratio = mean(ratio),
N = n())
rufus_petri_ratio_summary_modified <- rufus_petri_ratio_summary[-c(3, 4, 5, 6, 7, 8, 9, 10, 15), ]
lme_rufus_petri_ratio_summary_modified <- lmer(data = rufus_petri_ratio_summary_modified, germ_ratio ~ treatment + (1 | scientificName), REML = FALSE)
summary(lme_rufus_petri_ratio_summary_modified)
null7 <- lmer(data = rufus_petri_ratio_summary_modified, germ_ratio ~ 1 + (1 | scientificName), REML = FALSE)
anova(null7, lme_rufus_petri_ratio_summary_modified, test = "Chisq")
r.squaredGLMM(lme_rufus_petri_ratio_summary_modified)
rufus_ground_ratio_summary <- rufus_ground %>%
group_by(scientificName, treatment) %>%
summarise( germ_ratio = mean(ratio),
N = n())
rufus_ground_ratio_summary_modified <- rufus_ground_ratio_summary[-c(1, 2, 3, 8), ]
lme_rufus_ground_ratio_summary_modified <- lmer(data = rufus_ground_ratio_summary_modified, germ_ratio ~ treatment + (1 | scientificName), REML = FALSE)
summary(lme_rufus_ground_ratio_summary_modified)
null8 <- lmer(data = rufus_ground_ratio_summary_modified, germ_ratio ~ 1 + (1 | scientificName), REML = FALSE)
anova(null8, lme_rufus_ground_ratio_summary_modified, test = "Chisq")
r.squaredGLMM(lme_rufus_ground_ratio_summary_modified)
jollyae_petri_ratio_summary <- jollyae_petri %>%
group_by(scientificName, treatment) %>%
summarise( germ_ratio = mean(ratio),
N = n())
jollyae_petri_ratio_summary_modified <- jollyae_petri_ratio_summary
lme_jollyae_petri_ratio_summary_modified <- lmer(data = jollyae_petri_ratio_summary_modified, germ_ratio ~ treatment + (1 | scientificName), REML = FALSE)
summary(lme_jollyae_petri_ratio_summary_modified)
null9 <- lmer(data = jollyae_petri_ratio_summary_modified, germ_ratio ~ 1 + (1 | scientificName), REML = FALSE)
anova(null9, lme_jollyae_petri_ratio_summary_modified, test = "Chisq")
r.squaredGLMM(lme_jollyae_petri_ratio_summary_modified)
jollyae_semi_ratio_summary <- jollyae_semi %>%
group_by(scientificName, treatment) %>%
summarise( germ_ratio = mean(ratio),
N = n())
jollyae_semi_ratio_summary_modified <- jollyae_semi_ratio_summary
lme_jollyae_semi_ratio_summary_modified <- lmer(data = jollyae_semi_ratio_summary_modified, germ_ratio ~ treatment + (1 | scientificName), REML = FALSE)
summary(lme_jollyae_semi_ratio_summary_modified)
null10 <- lmer(data = jollyae_semi_ratio_summary_modified, germ_ratio ~ 1 + (1 | scientificName), REML = FALSE)
anova(null10, lme_jollyae_semi_ratio_summary_modified, test = "Chisq")
r.squaredGLMM(lme_jollyae_semi_ratio_summary_modified)
jollyae_closed_ratio_summary <- jollyae_closed %>%
group_by(scientificName, treatment) %>%
summarise( germ_ratio = mean(ratio),
N = n())
jollyae_closed_ratio_summary_modified <- jollyae_closed_ratio_summary[-c(5), ]
lme_jollyae_closed_ratio_summary_modified <- lmer(data = jollyae_closed_ratio_summary_modified, germ_ratio ~ treatment + (1 | scientificName), REML = FALSE)
summary(lme_jollyae_closed_ratio_summary_modified)
null11 <- lmer(data = jollyae_closed_ratio_summary_modified, germ_ratio ~ 1 + (1 | scientificName), REML = FALSE)
anova(null11, lme_jollyae_closed_ratio_summary_modified, test = "Chisq")
r.squaredGLMM(lme_jollyae_closed_ratio_summary_modified)
# Creating a status colum to indicate that all of the seeds germinated at some point
rufus_petri_yes$status <- rep(1, times = 121, length.out = NA, each = 1)
# Next we use the survival function to make a survival curve
rufus_petri_yes_km_fit <- survfit(Surv(germ_time, status) ~ treatment, data = rufus_petri_yes)
# This give a nice summary of the analysis
summary(rufus_petri_yes_km_fit, times = c(1,15,30,45,60,75,90))
# Next we plot the survival fit and make it look like the graph in the paper
rufus_petri_yes_km_plot <- autoplot(rufus_petri_yes_km_fit)
rufus_petri_yes_km_plot + labs(title = "Microcebus rufus",subtitle = "Petri dish experiment",
y = "Probability of germinating", x = "Time (days)") +
theme(plot.title = element_text(face = "italic")) +
scale_color_manual(values=c("darkgreen", "darkorange3")) +
scale_fill_manual(values=c("darkgreen", "darkorange3")) +
geom_text(x=75, y=.2, label="p < 0.0001") + theme(legend.position="bottom")
rufus_petri_yes_km_plot + labs(title = "Microcebus rufus",subtitle = "Petri dish experiment",
y = "Probability of germinating", x = "Time (days)") +
theme(plot.title = element_text(face = "italic")) +
scale_color_manual(values=c("darkgreen", "darkorange3")) +
scale_fill_manual(values=c("darkgreen", "darkorange3")) +
geom_text(x=75, y=.75, label="p < 0.0001") + theme(legend.position="bottom") + scale_y_reverse()
rufus_petri_yes_cox <- coxph(Surv(germ_time, status) ~ treatment, data=rufus_petri_yes)
summary(rufus_petri_yes_cox)
#Creating a status colum to indicate that all of the seeds germinated at some point
rufus_ground_yes$status <- rep(1, times = 7, length.out = NA, each = 1)
# Next we use the survival function to make a survival curve
rufus_ground_yes_km_fit <- survfit(Surv(germ_time, status) ~ 1, data = rufus_ground_yes)
# This gives a nice summary of the analysis
summary(rufus_ground_yes_km_fit, times = c(1,15,30,45,60,75,90))
rufus_ground_yes_km_plot <- autoplot(rufus_ground_yes_km_fit)
rufus_ground_yes_km_plot + labs(title = "Microcebus rufus",subtitle = "Forest ground experiment",
y = "Probability of germinating", x = "Time (days)") +
theme(plot.title = element_text(face = "italic")) +
scale_color_manual(values=c("darkorange3")) +
scale_fill_manual(values=c("darkorange3")) + theme(legend.position="bottom")
rufus_ground_yes_km_plot + labs(title = "Microcebus rufus",subtitle = "Forest ground experiment",
y = "Probability of germinating", x = "Time (days)") +
theme(plot.title = element_text(face = "italic")) +
scale_color_manual(values=c("darkorange3")) +
scale_fill_manual(values=c( "darkorange3")) + theme(legend.position="bottom") + scale_y_reverse()
# Creating a status colum to indicate that all of the seeds germinated at some point
jollyae_petri_yes$status <- rep(1, times = 70, length.out = NA, each = 1)
# Next we use the survival function to make a survival curve
jollyae_petri_yes_km_fit <- survfit(Surv(germ_time, status) ~ treatment, data = jollyae_petri_yes)
# This give a nice summary of the analysis
summary(jollyae_petri_yes_km_fit, times = c(1,15,30,45,60,75,90))
# jollyae_petri_yes_km_plot <- autoplot(jollyae_petri_yes_km_fit)
# jollyae_petri_yes_km_plot
jollyae_petri_yes_cox <- coxph(Surv(germ_time, status) ~ treatment, data=jollyae_petri_yes)
summary(jollyae_petri_yes_cox)
# Creating a status colum to indicate that all of the seeds germinated at some point
jollyae_semi_yes$status <- rep(1, times = 233, length.out = NA, each = 1)
# Next we use the survival function to make a survival curve
jollyae_semi_yes_km_fit <- survfit(Surv(germ_time, status) ~ treatment, data = jollyae_semi_yes)
# This give a nice summary of the analysis
summary(jollyae_semi_yes_km_fit, times = c(1,15,30,45,60,75,90))
# Next we plot the survival fit and make it look like the graph in the paper
jollyae_semi_yes_km_plot <- autoplot(jollyae_semi_yes_km_fit)
jollyae_semi_yes_km_plot + labs(title = "Microcebus jollyae",subtitle = "Semi-shaded experiment",
y = "Probability of germinating", x = "Time (days)") +
theme(plot.title = element_text(face = "italic")) +
scale_color_manual(values=c("darkgreen", "darkorange3")) +
scale_fill_manual(values=c("darkgreen", "darkorange3")) +
geom_text(x=75, y=.2, label="p = 0.2") + theme(legend.position="bottom")
jollyae_semi_yes_km_plot + labs(title = "Microcebus jollyae",subtitle = "Semi-shaded experiment",
y = "Probability of germinating", x = "Time (days)") +
theme(plot.title = element_text(face = "italic")) +
scale_color_manual(values=c("darkgreen", "darkorange3")) +
scale_fill_manual(values=c("darkgreen", "darkorange3")) +
geom_text(x=75, y=.75, label="p = 0.2") + theme(legend.position="bottom") + scale_y_reverse()
jollyae_semi_yes_cox <- coxph(Surv(germ_time, status) ~ treatment, data=jollyae_semi_yes)
summary(jollyae_semi_yes_cox)
#Creating a status colum to indicate that all of the seeds germinated at some point
jollyae_closed_yes$status <- rep(1, times = 61, length.out = NA, each = 1)
# Next we use the survival function to make a survival curve
jollyae_closed_yes_km_fit <- survfit(Surv(germ_time, status) ~ treatment, data = jollyae_closed_yes)
# This give a nice summary of the analysis
summary(jollyae_closed_yes_km_fit, times = c(1,15,30,45,60,75,90))
jollyae_closed_yes_km_plot <- autoplot(jollyae_closed_yes_km_fit)
jollyae_closed_yes_km_plot + labs(title = "Microcebus jollyae",subtitle = "Shaded experiment",
y = "Probability of germinating", x = "Time (days)") +
theme(plot.title = element_text(face = "italic")) +
scale_color_manual(values=c("darkgreen", "darkorange3")) +
scale_fill_manual(values=c("darkgreen", "darkorange3")) +
geom_text(x=75, y=.2, label="p = .7") + theme(legend.position="bottom")
jollyae_closed_yes_km_plot + labs(title = "Microcebus jollyae",subtitle = "closed-shaded experiment",
y = "Probability of germinating", x = "Time (days)") +
theme(plot.title = element_text(face = "italic")) +
scale_color_manual(values=c("darkgreen", "darkorange3")) +
scale_fill_manual(values=c("darkgreen", "darkorange3")) +
geom_text(x=75, y=.75, label="p = .7") + theme(legend.position="bottom") + scale_y_reverse()
jollyae_closed_yes_cox <- coxph(Surv(germ_time, status) ~ treatment, data=jollyae_closed_yes)
summary(jollyae_closed_yes_cox)
